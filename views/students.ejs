<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Students</h2>
  <a href="/students/add" class="btn btn-success">Add Student</a>
</div>

<!-- Added search form to demonstate reflected xss vulnerability -->
<form action="/students/search" method="GET" class="mb-3">
  <input type="text" name="q" class="form-control" placeholder="Search students...">
</form>

<table class="table table-striped">
  <thead><tr><th>ID</th><th>Name</th><th>Course</th><th>Actions</th></tr></thead>
  <tbody>
    <% students.forEach(s => { %>
      <tr>
        <td><%= s.id %></td>
        <!--Removed escaping to demonstrate stored XSS vulnerability-->
        <td><%- s.name %></td>
        <td><%= s.course || '' %></td>
        <td>
          <a href="/students/edit/<%= s.id %>" class="btn btn-sm btn-warning">Edit</a>
          <form action="/students/delete/<%= s.id %>" method="POST" style="display:inline">
            <button class="btn btn-sm btn-danger">Delete</button>
          </form>
        </td>
      </tr>
    <% }) %>
  </tbody>
</table>


<!-- Dom based XSS vulnerability demonstration script -->
<script>
  //Malicious script injected via URL parameter "msg", will be executed when page loads
  const params = new URLSearchParams(window.location.search);
  //The messsage parameter from the URL, could contain a script payload
  const message = params.get("msg");

  /*
  Allows payload to be executed, attacker could use this to steal cookies or 
  perform other malicious actions
  */
  if (message) {
    document.body.innerHTML +=
    '<div class="alert alert-info mt-3">' + message + '</div>';
  }
</script>

